@using WasySender_2_0.Models;
@using Newtonsoft.Json;
@{
    ViewBag.Title = "DestinatariNew";
    var urlEx = "/ExampleFiles/DestinatariVisureCertificati.csv";
    Users u = new Users();
    u = JsonConvert.DeserializeObject<Users>(Request.Cookies["login"].Value);

}


<div class="col-lg-12">
    <div class="content-breadcrumb">DASHBOARD / CORRISPONDENZA / @(Request.QueryString["TipoDocumento"]=="0" ? "CERTIFICATO" : "VISURA") / SELEZIONA INTESTATARI / CARICA CSV</div>
</div>

<div class="default-page">
    <div class="col-lg-12">
        <section>
            @using (Html.BeginForm("GeneraPreventivo", "Visure", FormMethod.Post, new { @class = "request-form", onsubmit = "PreloadOperation()" }))
            {
                <div class="row">
                    <div class="col-lg-12 text-center">
                        <h1>NUOVA LISTA INTESTATARI</h1>
                    </div>
                </div>
                <div class="row">
                    <div class="destinatari-new">
                        <div class="col-lg-6 col-md-6">
                            <div class="row">
                                <div class="col-lg-12">
                                    <label><span>1</span>CARICA NUOVA LISTA <em>(in formato .csv come da esempio) <input type="text" name="destinatari" value="" required class="reqDestinatari" /></em></label>
                                    <div class="dropZoneForm relative">
                                        <div id="myId" class="fallback dropzone"></div>
                                        <span class="preload-file">
                                            <img src="~/Images/preload.gif" /><br />
                                            Caricamento file in corso
                                        </span>
                                    </div>
                                    <span class="progress">
                                        <span class="progress-bar">0%</span>
                                    </span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <a href="@urlEx" target="_blank"><img src="~/Images/IcnInfo.png" />&nbsp;&nbsp;&nbsp;Scarica il file esempio in formato .CSV</a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-6">
                            <label><span>2</span>RISULTATO CARICAMENTO</label>
                            <div class="content-result-list">
                                <div class="result-load-list">
                                    <div class="row">
                                        <div class="col-lg-4 col-md-4">
                                            <article class="std">Nominativi caricati: <strong class="totali">-</strong></article>
                                        </div>
                                        <div class="col-lg-4 col-md-4">
                                            <article class="ok">Validi: <strong class="validi">-</strong></article>
                                        </div>
                                        <div class="col-lg-4 col-md-4">
                                            <article class="error">Errori: <strong class="errori">-</strong></article>
                                        </div>
                                    </div>
                                </div>
                                <ul class="top-result">
                                    <li>NOMINATIVO</li>
                                    <li>VALIDO</li>
                                    <li>TIPO DI ERRORE</li>
                                </ul>
                                <span class="responseList">
                                    <span class="preload-nominativi">
                                        <img src="~/Images/preload.gif" /><br />
                                        Attendere validazione nominativi in corso!
                                        <span class="progress">
                                            <span class="progress-bar-nominativi">0%</span>
                                        </span>
                                    </span>
                                </span>
                            </div>
                            <div class="error-msg"></div>
                            <div class="msg">
                                <strong>Il processo di caricamento della lista è terminato.</strong><br />
                                <p>
                                    Clicca su inserisci lista per salvare i nominativi validi oppure correggi gli
                                    errori evidenziati e ricarica la lista.
                                </p>
                            </div>
                            <span class="download-errors"><a href="/Corrispondenza/CreateErrorFile" class="d" target="_blank">scarica gli errori</a></span>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="nav-step">
                        <div class="col-lg-6 col-lg-offset-3 col-md-4 col-md-offset-4">
                            <div class="row">
                                <div class="col-lg-4">
                                    <a href="/Visure/Index?id=@Request.QueryString["TipoDocumento"]"><img src="~/Images/IcnPrev.png" /> INDIETRO</a>
                                </div>
                                <div class="col-lg-4">
                                    <a href="IntestatariNew?Sender=@Request.QueryString["Sender"]&SenderAR=@Request.QueryString["SenderAR"]&TipoDocumento=@Request.QueryString["TipoDocumento"]&CodiceDocumento=@Request.QueryString["CodiceDocumento"]&RicevutaRitorno=@Request.QueryString["RicevutaRitorno"]">ANNULLA</a>
                                </div>
                                <div class="col-lg-4">
                                    <button type="submit" class="prosegui">PREVENTIVO <img src="~/Images/IcnNext.png" /></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="Sender" value="@Request.QueryString["Sender"]" />
                <input type="hidden" name="SenderAR" value="@Request.QueryString["SenderAR"]" />
                <input type="hidden" name="TipoDocumento" value="@Request.QueryString["TipoDocumento"]" />
                <input type="hidden" name="CodiceDocumento" value="@Request.QueryString["CodiceDocumento"]" />
                <input type="hidden" name="RicevutaRitorno" value="@Request.QueryString["RicevutaRitorno"]" />
            }
        </section>
    </div>
    <span class="preload-operation">
        <img src="~/Images/preload.gif" /><br />
        Attendere inserimento dei nominativi nel database.
    </span>
</div>

<div class="bg-pop-up popup-std">
    <div class="col-lg-12">
        <div class="close-popup wowload delay-02 fadeIn">
            <a onclick="ClosePopup()" title="Chiudi Dettaglio"><img src="~/Images/IcnClose.png" /></a>
        </div>
    </div>
    <div class="pop-up">
        <div class="row">
            <div class="col-lg-12 text-center"><h1>MODIFICA IL NOMINATIVO</h1></div>
        </div>
        <div class="row">
            <div class="user-form">
                <div class="col-lg-12">
                    <div class="row">
                        <div class="col-lg-12 col-md-6 col-sm-6">
                            <label>NOMINATIVO <em>(Lunghezza massima 44 char)</em></label>
                            <input type="text" name="nominativoNames" value="" class="nominativoNames" maxlength="44" required />
                        </div>
                        <div class="col-lg-12 col-md-6 col-sm-6">
                            <label>CCIAA <em>(SOLO 2 LETTERE. Sigla della provincia)</em></label>
                            <input type="text" name="provinciaNames" maxlength="2" minlength="2" style="text-transform:uppercase;" value="" class="provinciaNames" required
                                   onkeypress="return onlyLetters(event);" />
                        </div>
                        <div class="col-lg-12 col-md-6 col-sm-6">
                            <label>CODICE FISCALE / PARTITA IVA</label>
                            <input type="text" name="fiscalCodeNames" maxlength="18" minlength="18" style="text-transform:uppercase;" value="" class="fiscalCodeNames" required />
                        </div>
                        <div class="col-lg-12 col-md-6 col-sm-6">
                            <label>NUMERO REA</label>
                            <input type="text" name="NREANames" style="text-transform:uppercase;" value="" class="NREANames" required onkeypress="return onlyNumbers(event);" />
                        </div>
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <input type="submit" name="save" value="INSERISCI" onclick="validateForm()" />
                        </div>
                        <div class="col-lg-12">
                            <div class="error-msg error-popup"></div>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="index" class="index" />
            </div>
        </div>
    </div>
</div>

@Styles.Render("~/Content/dropZoneStyles")
@Scripts.Render("~/bundles/dropZone")
<script>
    var userId = @ViewBag.userId;
    var sessionId = "@ViewBag.sessionId";
    var areaTestUser = "@ViewBag.areaTestUser";
</script>
@Scripts.Render("~/bundles/visure/IntestatariNew")
